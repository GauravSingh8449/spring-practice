<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Secure Payment</title>
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<style>
body {
  margin: 0;
  padding: 0;
  font-family: 'Roboto', sans-serif;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
  overflow: hidden;
  position: relative;
}

/* Background blobs */
.shape {
  position: absolute;
  border-radius: 50%;
  opacity: 0.15;
  animation: float 20s infinite ease-in-out alternate;
  z-index: 1;
}
.shape1 { width: 300px; height: 300px; background: #ff6b6b; top: -80px; left: -80px; }
.shape2 { width: 400px; height: 400px; background: #5f27cd; bottom: -150px; right: -100px; }
.shape3 { width: 250px; height: 250px; background: #1dd1a1; top: 15%; left: 75%; }

@keyframes float {
  0% { transform: translateY(0) }
  50% { transform: translateY(-20px) }
  100% { transform: translateY(0) }
}

/* Card */
.payment-card {
  position: relative;
  z-index: 10;
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
  border-radius: 25px;
  padding: 50px 40px 40px 40px;
  width: 100%;
  max-width: 450px;
  box-shadow: 0 20px 50px rgba(0,0,0,0.4);
  animation: cardFloat 6s ease-in-out infinite alternate;
}

@keyframes cardFloat {
  0% { transform: translateY(0) }
  50% { transform: translateY(-10px) }
  100% { transform: translateY(0) }
}

h2 {
  color: #fff;
  margin-bottom: 30px;
  font-weight: 700;
  font-size: 30px;
  text-align: center;
}

/* Input fields */
.input-icon {
  position: relative;
  width: 100%;
  margin-bottom: 20px;
}
.input-icon i {
  position: absolute;
  top: 50%;
  left: 15px;
  transform: translateY(-50%);
  color: #fff;
  font-size: 18px;
}
.input-icon input {
  width: 100%;
  padding: 14px 15px 14px 45px;
  border-radius: 15px;
  border: none;
  font-size: 16px;
  background: rgba(255,255,255,0.12);
  color: #fff;
  transition: 0.3s;
}
.input-icon input:focus {
  outline: none;
  box-shadow: 0 0 15px rgba(95,39,205,0.6);
  background: rgba(255,255,255,0.2);
}
.input-icon input::placeholder {
  color: #fff;
  font-weight: 500;
  opacity: 0.8;
}

/* Buttons */
.btn-pay, .btn-back {
  font-weight: 600;
  border-radius: 12px;
  padding: 14px;
  width: 100%;
  font-size: 18px;
  border: none;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
}

.btn-pay {
  background: linear-gradient(135deg, #5f27cd, #ff6b6b);
  color: #fff;
}
.btn-pay:hover {
  transform: translateY(-3px);
  box-shadow: 0 15px 35px rgba(0,0,0,0.35);
}

.btn-back {
  background: rgba(255,255,255,0.2);
  color: #fff;
  margin-top: 20px; /* space between Pay and Back */
  border-radius: 12px;
  padding: 14px;
  width: 100%;
  font-size: 18px;
  border: none;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
}
.btn-back:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(0,0,0,0.25);
}


/* Result */
#result {
  text-align: center;
  font-weight: 500;
  margin-top: 15px;
  font-size: 16px;
  min-height: 20px;
  color: #ff6b6b;
}
#result.success { color: #2ecc71; }

/* Responsive */
@media(max-width: 480px){
  .payment-card { width: 90%; padding: 35px 25px; }
  h2 { font-size: 24px; }
  .btn-pay, .btn-back { font-size: 16px; padding: 12px; }
}
</style>
</head>
<body>

<div class="shape shape1"></div>
<div class="shape shape2"></div>
<div class="shape shape3"></div>

<div class="payment-card">
  <h2>Secure Payment</h2>
  <div class="input-icon"><i class="bi bi-person-fill"></i><input type="text" id="name" class="form-control" placeholder="Full Name"></div>
  <div class="input-icon"><i class="bi bi-envelope-fill"></i><input type="email" id="email" class="form-control" placeholder="Email Address"></div>
  <div class="input-icon"><i class="bi bi-telephone-fill"></i><input type="text" id="contact" class="form-control" placeholder="Contact Number"></div>
  <div class="input-icon"><i class="bi bi-currency-dollar"></i><input type="number" id="amount" class="form-control" value="500" placeholder="Amount (INR)"></div>
  <button class="btn-pay" onclick="startPayment()">Pay Now</button>
  <button class="btn-back" onclick="history.back()"><i class="bi bi-arrow-left"></i> Back</button>
  <p id="result"></p>
</div>

<script>
async function startPayment() {
  const name = document.getElementById("name").value;
  const email = document.getElementById("email").value;
  const contact = document.getElementById("contact").value;
  const amount = document.getElementById("amount").value;
  const resultEl = document.getElementById("result");
  resultEl.classList.remove("success");
  resultEl.textContent = "";

  if(!name || !email || !contact || !amount){
    resultEl.textContent = "Please fill all the fields!";
    return;
  }

  try {
    const orderResp = await fetch(`http://localhost:8080/payment/create-order?amount=${amount}&name=${name}&email=${email}&contact=${contact}`, { method: "POST" });
    if(!orderResp.ok){ resultEl.textContent = await orderResp.text(); return; }
    const order = await orderResp.json();

    const options = {
      key: "rzp_test_REHfhtxg8O13Sj", // apna Razorpay key
      amount: order.amount,
      currency: order.currency,
      name,
      description: "Payment for order " + order.id,
      order_id: order.id,
      handler: async function(response){
        const verifyResp = await fetch("http://localhost:8080/payment/verify-payment", {
          method:"POST",
          headers:{"Content-Type":"application/json"},
          body: JSON.stringify({
            orderId: response.razorpay_order_id,
            paymentId: response.razorpay_payment_id,
            razorpaySignature: response.razorpay_signature,
            name, email, amount, contact
          })
        });
        const text = await verifyResp.text();
        resultEl.textContent = text;
        if(verifyResp.ok) {
          resultEl.classList.add("success");
          document.getElementById("name").value = "";
          document.getElementById("email").value = "";
          document.getElementById("contact").value = "";
          document.getElementById("amount").value = "";
        }
      },
      prefill: { name, email, contact },
      theme: { color: "#5f27cd" }
    };
    const rzp = new Razorpay(options); rzp.open();

  } catch(err){
    console.error(err);
    resultEl.textContent = "Something went wrong!";
  }
}
</script>

</body>
</html>
